
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="author" content="guchio3" />
        <meta name="keywords" content="Research,Paper,Memory Augmented Neural Network,Few-Shot Learning" />
        <meta name="description" content="Memory-Augmented Neural Networks (MANN) を使った Few-shot learning の試み" />


    <title>Meta-Learning with Memory-Augmented Neural Networks - guchiBLO</title>

        <link rel="stylesheet" href="https://guchio3.github.io/guchiBLO/theme/css/bootstrap.min.css" type="text/css" />

    <link href="https://guchio3.github.io/guchiBLO/theme/css/font-awesome.min.css" rel="stylesheet" />
    <link href="https://guchio3.github.io/guchiBLO/theme/css/pygments/native.css" rel="stylesheet" />
    
    <link href="https://guchio3.github.io/guchiBLO/theme/css/pelican-twitchy.min.css" rel="stylesheet" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Feeds -->
        <link href="https://guchio3.github.io/guchiBLO/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="guchiBLO ATOM Feed" />
</head>
<body data-spy="scroll" data-target="#scrollspy">
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper-small" class="twitchy-background">
            <ul id="accordion-small" class="sidebar-nav sidebar-nav-small">
                <li>
        <a href="https://guchio3.github.io/guchiBLO" title="guchiBLO" class="collapsed">
            <span class="glyphicon glyphicon-home"></span>
        </a>
    </li>
                <li class="nav-divider"></li>
                <li>
        <a href="https://guchio3.github.io/guchiBLO/archives.html" title="Recent Articles" class="collapsed">
            <span class="glyphicon glyphicon-th-list"></span>
        </a>
    </li>
                
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion-small" href="#collapse-social-small" title="Social" class="collapsed">
                        <i class="fa fa-users padding-small"></i>
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social-small" class="collapse ">
                    <li>
                        <a href="https://github.com/guchio3" title="github"><i class="fa fa-github-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/taguchi-naoya-545403121/" title="linkedin"><i class="fa fa-linkedin-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="https://twitter.com/ihcgT_Ykchi" title="twitter"><i class="fa fa-twitter-square fa-lg padding-small"></i></a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
        <a href="#" title="Back to top" class="collapsed">
            <span class="fa fa-arrow-up"></span>
        </a>
    </li>
            </ul>
        </div>
        <div id="sidebar-wrapper" class="twitchy-background">
            <ul id="accordion" class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="https://guchio3.github.io/guchiBLO/">
<img src="https://guchio3.github.io/guchiBLO//images/siteBaseImages/guchiBLO_temp.png" width="200" alt="Sitelogo"/>                     </a>
                </li>
                    <li>
                        <a href="https://guchio3.github.io/guchiBLO/archives.html">
                            <span class="glyphicon glyphicon-th-list padding-small"></span>
                            Recent Articles
                        </a>
                    </li>
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-social">
                        <i class="fa fa-users padding-small"></i>
                        Contact
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social" class="sidebar_submenu collapse ">
                    <li>
                        <a href="https://github.com/guchio3" title="github">
                            <i class="fa fa-github-square fa-lg padding-small"></i>
                            github
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/taguchi-naoya-545403121/" title="linkedin">
                            <i class="fa fa-linkedin-square fa-lg padding-small"></i>
                            linkedin
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/ihcgT_Ykchi" title="twitter">
                            <i class="fa fa-twitter-square fa-lg padding-small"></i>
                            twitter
                        </a>
                    </li>
                </ul></li>
                
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-pages">
                        <i class="fa fa-folder-open padding-small"></i>
                        Pages
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-pages" class="sidebar_submenu collapse ">
                    <li>
                        <a href="https://guchio3.github.io/guchiBLO/pages/AUTHOR.html">
                            <i class="fa fa-file-text padding-small"></i>
                            AUTHOR
                        </a>
                    </li>
                    <li>
                        <a href="https://guchio3.github.io/guchiBLO/pages/CONTENTS.html">
                            <i class="fa fa-file-text padding-small"></i>
                            CONTENTS
                        </a>
                    </li>
                </ul></li>
                
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-categories">
                        <i class="fa fa-folder-open padding-small"></i>
                        Categories
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-categories" class="sidebar_submenu collapse ">
                    <li >
                        <a href="https://guchio3.github.io/guchiBLO/category/cryptocurrency.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            CryptoCurrency
                            <span class="badge pull-right categorybadge">1</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="https://guchio3.github.io/guchiBLO/category/machinelearning.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            MachineLearning
                            <span class="badge pull-right categorybadge">8</span>
                        </a>
                    </li>
                </ul></li>
                
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- open/close sidebar -->
        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">
            <span id="right-arrow" class="glyphicon glyphicon-chevron-right"  title="expand sidebar"></span>
            <span id="left-arrow" class="glyphicon glyphicon-chevron-left" title="minimize sidebar"></span>
        </a>
       <!-- /open/close sidebar -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
<section id="content">
    <article>
        <div class="row">
            <div class="col-lg-9">
                <header class="page-header">
                    <h1>
                        <a href="https://guchio3.github.io/guchiBLO/Meta-Learning_with_Memory-Augmented_Neural_Networks.html"
                           rel="bookmark"
                           title="Permalink to Meta-Learning with Memory-Augmented Neural Networks">
                            Meta-Learning with Memory-Augmented Neural Networks
                        </a>
                        <small>
<div class="post-info">
    <div class="publish-info-block">
        <small>
            <span class="published">
                <i class="fa fa-calendar padding-small"></i><time datetime="2017-10-13T00:00:00+09:00"> 金 13 10月 2017</time>
            </span>
            <span class="category">
                <i class="fa fa-folder-open padding-small"></i><a href="https://guchio3.github.io/guchiBLO/category/machinelearning.html">MachineLearning</a>
            </span>
            <span class="tags">
                <i class="fa fa-tags padding-small"></i>
                <a href="https://guchio3.github.io/guchiBLO/tag/research.html">Research</a> /                 <a href="https://guchio3.github.io/guchiBLO/tag/paper.html">Paper</a> /                 <a href="https://guchio3.github.io/guchiBLO/tag/memory-augmented-neural-network.html">Memory Augmented Neural Network</a> /                 <a href="https://guchio3.github.io/guchiBLO/tag/few-shot-learning.html">Few-Shot Learning</a>            </span>
        </small>
    </div>
</div><!-- /.post-info -->                        </small>
                    </h1>
                </header>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-9">
                <div class="entry-content">
                    <h1>Outline</h1>
<p>ちょっと古いけど読めていなかった <a href="http://proceedings.mlr.press/v48/santoro16.pdf">Meta-Learning with Memory-Augmented Neural Networks</a> を読んだのでメモ。</p>
<p>従来の gradient-based network は学習に大量のデータを必要とするため、新種のデータが入力された場合に対応するのが難しいが、Memory-Augmented Neural Networks (MANN) はこの状況に対応できそうだからやってみたという論文。</p>
<p>タイトルにあるようにこの論文では Meta-Learning を行うことを軸に議論を展開している。<br>
この論文において Meta-Learning は以下の用に解釈される。</p>
<blockquote>
<p>Although the term has been used in numerous senses, meta-learning generally refers to a scenario in which an agent learns at two levels, each associated with different time scales.</p>
<p>Given its two-tiered organization, this form of meta- learning is often described as “learning to learn.”</p>
</blockquote>
<p>つまり、Meta-Learning では短期的な学習と長期的な学習の２種類の学習を組み合わせて学習が行われる。<br>
短期的な学習では１つのタスクについての学習が行われ、長期的な学習ではこのような短期的な学習の仕方、つまりタスク一般についての学習の仕方が学習される。  </p>
<p>現状、Meta-Learning は Recurrent Neural Networks (RNN) など記憶能力をもつ Neural Networks (NN) によりある程度行えるらしい。<br>
しかし、Scalable な Meta-Learning を行うには以下の２つの制約を満たす必要がある。</p>
<ul>
<li>記憶される情報が静的に保存され、かつそれらの情報に個別にアクセスできる。</li>
<li>パラメーターの数と記憶できる情報の量に依存関係が無い。</li>
</ul>
<p>これらの条件は通常の RNN などでは普通満たされないが、MANN はこれを満たすため、この論文では MANN の一種である <a href="https://arxiv.org/pdf/1410.5401.pdf">Neural Turing Machine</a> (NTM) を用いて Meta-Learning を行っている。</p>
<p>以降、図は特に指定がない限り元論文から引用。</p>
<hr>
<h1>Meta-Learning Task Methodology</h1>
<h3>Optimization</h3>
<p>Neural Network を使った機械学習においては通常、あるデータセット <span class="math">\(D\)</span> についてパラメータ <span class="math">\(\theta\)</span> を、学習コスト <span class="math">\(\cal L\)</span> を最小化するように調整する。</p>
<p>一方 Meta-Learning では以下の式 (\ref{meta_learn_func}) のように、データセットの分布 <span class="math">\(p(D)\)</span> に対して同様の最適化を図る。</p>
<div class="math">\begin{equation}
\label{meta_learn_func}
    \theta^{*} = argmin_{\theta}E_{D\sim p(D)}[{\cal L}(D;\theta)]
\end{equation}</div>
<h3>Tasks</h3>
<p>またこの論文におけるタスクは、系列型のデータセット <span class="math">\(D = {d_t}^{T}_{t=1} = {({\bf x}_t, y_t)}^{T}_{t=1}\)</span> (<span class="math">\({\bf x_t}\)</span> は入力、<span class="math">\(y_t\)</span> は入力に対する適切な正解ラベル) について行われるが、Few-shot learning を行うため少しトリッキー (下の図参照)。<br>
なお、下の図には Class Prediction と書かれているが分類だけでなく回帰も同様に扱う。</p>
<p>すなわち、時間 <span class="math">\(t\)</span> においてモデルは <span class="math">\({\bf x_t}\)</span> および <span class="math">\(y_{t-1}\)</span> を入力として受け取り、<span class="math">\({\bf x_t}\)</span> に対応する正しいラベル <span class="math">\(y_t\)</span> を出力するように学習を行う。よって <span class="math">\(t = 0\)</span> での <span class="math">\(y_{t-1}\)</span> を <span class="math">\(null\)</span> としたとき、モデルが入力として受けとる系列データは <span class="math">\(({\bf x_1}, null), ({\bf x_2}, y_1), ..., ({\bf x_T}, y_{T-1})\)</span>、これに対してモデルが理想的に出力する系列データは <span class="math">\(y_1, y_2 , ..., y_t\)</span> である。</p>
<p>なおこのタスクで扱うデータセットは一つではなく、モデルが大量のデータから各データセットの <span class="math">\({\bf x_t}\)</span> に対する <span class="math">\(y_t\)</span> を長期的な学習の中で憶えてしまって純粋な Few-shot learning が行えなくなるのを防ぐため、下の図のように <span class="math">\({\bf x_t}\)</span> に対する <span class="math">\(y_t\)</span> は各データセットの学習開始時に毎回シャッフルされる。<br>
そのため、<span class="math">\(t = 1\)</span> における <span class="math">\(y_1\)</span> は正解しようのないラベルとなる。</p>
<p><img alt="figure1_a" src="https://guchio3.github.io/guchiBLO/images/Research/Meta-Learning_with_Memory_Augmented_Neural_Networks/figure1_a.jpg" style="display:block;margin-left:auto;margin-right:auto;" width="500px"></p>
<hr>
<h1>Memory-Augmented Model</h1>
<p>MANN は近年研究され始めたモデルであり、主に NTM と <a href="https://arxiv.org/pdf/1410.3916.pdf">Memory Networks</a> に基づくモデルが幾つか提案されている。</p>
<p>この論文では NTM を用いて Few-shot learning を行っているが、オリジナルの NTM に対して Least Recently Used Access を認識できるよう改良を加えている。<br>
詳細は時間の都合上省略。(時間のあるときに追記。)</p>
<hr>
<h1>Experimental Results</h1>
<p>この論文では Few-shot learning に関して分類、回帰問題のそれぞれについて、<a href="https://github.com/brendenlake/omniglot">Omniglot</a> および sampled functions from a Gaussian process という２つのデータセットを用いて実験を行っている。<br>
本記事では時間の都合上この内、Omniglot、つまり分類問題に関してのみ書く。</p>
<p>Omniglot は以下の図に示すような手書き文字の画像データセット。 (Paper : <a href="http://web.mit.edu/cocosci/Papers/Science-2015-Lake-1332-8.pdf">Human-level concept learning through probabilistic program introduction</a> より引用。)<br>
1600 以上のクラスがあり、各クラス毎に幾つかのサンプルがある。<br>
この論文ではそれらを更に 90, 180, 270 度回転させて data augmentation を行っている。</p>
<p><img alt="omniglot" src="https://guchio3.github.io/guchiBLO/images/Research/Meta-Learning_with_Memory_Augmented_Neural_Networks/omniglot.jpg" style="display:block;margin-left:auto;margin-right:auto;" width="700px"></p>
<p>タスクは上の Tasks に書いたように行われる。<br>
入力された画像がどのクラスのものかということも大事だが、どのクラスでないかを認識して消去法的にクラス分類も行うこともできる。</p>
<p>学習は 100,000 データセットに対して行われ、各データセットは Omniglot からランダムに 5 つ選ばれたクラスに対してランダムなラベルを付与することで構成される。<br>
その他詳細は論文参照。</p>
<p>下の図が実際の動作イメージ。<br>
前半でクラス２の画像が２であることが判明しており、Few-shot learning ができる場合後半で同じクラスの画像を正しく２と分類できている。</p>
<p><img alt="figure1_b" src="https://guchio3.github.io/guchiBLO/images/Research/Meta-Learning_with_Memory_Augmented_Neural_Networks/figure1_b.jpg" style="display:block;margin-left:auto;margin-right:auto;" width="500px"></p>
<p>そして下の表が実験結果。</p>
<p>HUMAN, LSTM, MANN はデータ入力されるにつれて基本的には精度が上がっており、MANN が非常に良い性能を出している。 <br>
なお、FEEDFORWARD は feed-forward RNN を指す。</p>
<p>人間が 1st で 1/5 の確率でしか当たらないはずのラベルを 34.5% で当てているは懐疑的なのでもしかしたら実験設定について何か勘違いしているのかも...。<br>
一応、これよりも高い精度で 1st を分類している MANN は educated guessing (学習により良いあてずっぽう推測ができるようになった？) と書かれているがラベルはデータセットごとに
よくわかっていない...  </p>
<p><img alt="result_table" src="https://guchio3.github.io/guchiBLO/images/Research/Meta-Learning_with_Memory_Augmented_Neural_Networks/result_table.jpg" style="display:block;margin-left:auto;margin-right:auto;" width="400px"></p>
<p>下の図は LSTM および MANN の学習曲線。a, b は出力に onehot-vector を用いたもので、c, d は出力を文字列で行ったもの。文字列で行った場合、組み合わせによって大量のパターンを表現できるためクラス数が増えるに従いネットワークサイズが大きくなり学習が難しくなる onehot vector に比べてより多くのクラスを扱える。</p>
<p><img alt="learning_curves" src="https://guchio3.github.io/guchiBLO/images/Research/Meta-Learning_with_Memory_Augmented_Neural_Networks/learning_curves.jpg" style="display:block;margin-left:auto;margin-right:auto;" width="700px"></p>
<p>以上！</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
                </div>
                <footer class="text-right">
                    <p>- guchio3</p>
                </footer>
    <section id="comments" class="comments ">
        <hr/>
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </section>
            </div>
        </div>
    </article>
</section>
<footer>
    <hr>
    <div class="row">
        <div class="col-lg-9 text-center">
            <p><small>
                Built by <a href="http://docs.getpelican.com/en/latest">Pelican</a> / <a href="https://github.com/ingwinlu/pelican-twitchy">pelican-twitchy</a>
                &middot;                    &copy; 2017 guchio3
            </small></p>
        </div>
    </div>
</footer>            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>
    <!-- /#wrapper -->
    <!-- jQuery Version 1.11.2 -->
    <script src="https://guchio3.github.io/guchiBLO/theme/js/jquery-1.11.2.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="https://guchio3.github.io/guchiBLO/theme/js/bootstrap.min.js"></script>
    <!-- twitchy Script -->
    <script src="https://guchio3.github.io/guchiBLO/theme/js/pelican_twitchy.min.js"></script>
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-107917533-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

<!-- disqus -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'True'; // required: replace example with your forum shortname

            var disqus_identifier = 'Meta-Learning_with_Memory-Augmented_Neural_Networks';
        var disqus_url = 'https://guchio3.github.io/guchiBLO/Meta-Learning_with_Memory-Augmented_Neural_Networks.html';

    var disqus_config = function () {
        this.language = "en";
    };
        /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- /disqus -->
</body>
</html>